{% extends 'base.html' %}

{% block content %}
<div style="text-align:center; padding:20px;">
  <h1 style="font-size:2.2rem; color:#222;">üì∞ Latest News</h1>

  <!-- Search Form -->
  <div style="margin:20px auto;">
    <form method="get" action="{% url 'home' %}" style="display:flex; justify-content:center; gap:10px;">
      <input type="text" name="q" placeholder="Search news articles..." value="{{ search_query }}"
             style="padding:10px; width:250px; border:1px solid #ccc; border-radius:5px;">
      <button type="submit" style="padding:10px 15px; background:#007bff; color:#fff; border:none; border-radius:5px; cursor:pointer;">
        Search
      </button>
    </form>
  </div>
</div>

<!-- Article Grid -->
<div style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px; padding:20px;">
  {% for article in articles %}
  <div style="width:320px; border-radius:12px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.2); background:#fff; transition:transform 0.3s, box-shadow 0.3s;">
    {% if article.image %}
    <div style="position:relative; height:200px; overflow:hidden;">
      <img src="{{ article.image.url }}" alt="{{ article.title }}"
           style="width:100%; height:100%; object-fit:cover; transition:transform 0.3s;"
           onmouseover="this.style.transform='scale(1.05)'" 
           onmouseout="this.style.transform='scale(1)'" 
           onerror="this.style.display='none'">
    </div>
    {% endif %}

    <!-- Moving headline below image -->
    <marquee behavior="scroll" direction="left" scrollamount="5"
             style="background:#ffcc00; color:#222; font-weight:bold; padding:8px; font-size:1.05rem;">
      üóûÔ∏è {{ article.title }}
    </marquee>

    <div style="padding:15px; text-align:left;">
      <p style="font-size:0.9rem; color:#777; margin-bottom:10px;">
        by <strong>{{ article.author }}</strong> on {{ article.pub_date|date:"F d, Y" }}
      </p>

      <p style="font-size:1rem; color:#333; line-height:1.5; margin-bottom:10px;">
        {{ article.content|truncatewords:25 }}
      </p>

      {% if user.username == 'yaswanth' %}
      <div style="margin-top:10px;">
        <a href="{% url 'article_edit' article.pk %}" 
           style="padding:6px 12px; background:#3498db; color:#fff; text-decoration:none; border-radius:6px; margin-right:5px;">
           Edit
        </a>
        <a href="{% url 'article_delete' article.pk %}" 
           style="padding:6px 12px; background:#e74c3c; color:#fff; text-decoration:none; border-radius:6px;">
           Delete
        </a>
      </div>
      {% endif %}
    </div>
  </div>
  {% empty %}
  <div style="text-align:center; padding:50px;">
    {% if search_query %}
    <h2>No Results Found</h2>
    <p>Your search for "{{ search_query }}" did not match any articles. Please try a different term.</p>
    {% else %}
    <h2>Welcome to Django News!</h2>
    {% if user.username == 'yaswanth' %}
    <p>The page looks a little empty. Why not 
      <a href="{% url 'article_new' %}" style="color:#007bff; text-decoration:underline;">post the first article</a>?
    </p>
    {% else %}
    <p>No articles to display right now. Check back soon for the latest updates!</p>
    {% endif %}
    {% endif %}
  </div>
  {% endfor %}
</div>

{% endblock content %}
